## 3.2.2.2 人员免疫机制设定

COVID-19疫情传播过程中，个体免疫状态是影响病毒传播动力学和疾病进展的关键因素。传统的传染病模型通常将人群简化为"易感"和"免疫"两个状态，忽略了免疫力的动态变化、异质性以及不同免疫来源的差异。为了更真实地模拟COVID-19在人群中的传播，本研究采用基于中和抗体（Neutralizing Antibodies, NAb）水平的免疫建模方法，该方法能够刻画免疫力的动态衰减过程、不同变种间的交叉免疫效应，以及自然免疫与疫苗免疫的差异，为精准评估防控策略（特别是疫苗接种策略）提供了重要的理论基础。

### 免疫系统建模框架

Covasim平台采用基于中和抗体水平的免疫建模方法，其核心思想是将抽象的"免疫力"量化为可测量的中和抗体水平，进而通过数学模型将抗体水平转换为实际的免疫保护效果。这一建模方法基于大量真实世界的免疫学研究，能够准确反映COVID-19感染和疫苗接种后免疫系统的动态响应过程。

免疫建模的基本流程可以概括为：**中和抗体水平（NAb）→ 免疫保护力（Vaccine Efficacy, VE）→ 降低感染/症状/重症风险**。具体而言，当个体发生免疫事件（自然感染或疫苗接种）时，系统会为其分配一个峰值中和抗体水平（peak NAb），该水平随后会随时间衰减；在每个时间步，系统根据当前的NAb水平计算个体对病毒的免疫保护力，并将该保护力应用于三个不同的保护维度：降低易感性（susceptibility）、降低症状出现概率（symptomaticity）以及降低重症发生概率（severity）。

### 免疫的两个来源

模型中的免疫来自两个基本来源，每个来源都有其独特的特征和动态规律：

**自然免疫（Natural Immunity）**：自然免疫来源于个体从COVID-19感染中康复后获得的免疫保护。自然免疫的强度和质量受到多个因素的影响：（1）感染的变种类型，不同变种诱导的免疫反应强度不同；（2）症状严重程度，无症状感染、轻症和重症感染产生的抗体水平存在显著差异，通常重症感染产生的抗体水平最高，轻症次之，无症状感染最低；（3）康复后的时间，抗体水平会随时间衰减，免疫保护力逐渐下降。研究表明，自然感染后产生的抗体水平通常具有较大的个体差异，且对同源变种的保护效果较好，但对变异株的保护效果可能显著降低。

**疫苗免疫（Vaccine Immunity）**：疫苗免疫来源于个体接种COVID-19疫苗后获得的免疫保护。疫苗免疫的特征取决于：（1）疫苗类型，不同疫苗（如mRNA疫苗、灭活疫苗、腺病毒载体疫苗）的免疫原性和保护效果存在差异；（2）接种次数，初次接种、加强针接种产生的抗体水平不同，加强针通常能够显著提升抗体水平；（3）接种后的时间，疫苗诱导的抗体同样会随时间衰减。与自然免疫相比，疫苗免疫通常具有更可预测的抗体水平分布，且经过优化的疫苗配方可能对特定变种提供更好的保护。

在模型中，自然免疫和疫苗免疫通过取最大值的方式进行组合，即个体对某一变种的总体免疫保护力取自然免疫和疫苗免疫中的较大值。这一设计反映了现实世界中两种免疫来源可能提供不同强度的保护，而个体实际获得的保护取决于两者中较强的一方。

### 免疫保护的三个维度

免疫保护在三个不同的"轴"上发挥作用，每个维度对应疾病进展的不同阶段：

**易感性保护（Susceptibility Protection, $VE_{sus}$）**：易感性保护降低个体被病毒感染的概率。当易感个体与感染者接触时，其感染概率会因免疫保护而降低。易感性保护是免疫系统第一道防线，能够直接减少新感染的发生，从而降低疫情传播速度。

**症状保护（Symptomaticity Protection, $VE_{symp}$）**：症状保护降低感染后出现临床症状的概率。即使个体被感染，免疫系统仍可能通过快速清除病毒或抑制病毒复制，使感染表现为无症状或轻症。症状保护对于减少有症状感染者的数量具有重要意义，因为无症状感染者通常具有较低的传播风险。

**重症保护（Severity Protection, $VE_{sev}$）**：重症保护降低出现症状后发展为重症的概率。即使个体出现症状，免疫系统仍可能通过限制病毒复制和减轻炎症反应，防止疾病进展为需要住院治疗的重症。重症保护对于降低医疗系统负担和减少死亡风险至关重要。

这三个保护维度相互独立但又相互关联，共同构成了免疫系统的多层次防护体系。在模型中，每个维度的保护力都通过独立的数学函数计算，确保能够准确反映免疫系统在不同疾病阶段的保护效果。

### 中和抗体机制

#### 峰值NAb水平的设定

当个体发生免疫事件（感染或疫苗接种）时，系统会为其设定一个峰值中和抗体水平（peak NAb）。峰值NAb的设定遵循以下规则：

对于**首次获得抗体**的个体，峰值NAb水平从对数正态分布中抽样得到：

$$\text{peak\_NAb} = 2^{X}, \quad X \sim \mathcal{N}(\mu, \sigma^2)$$

其中，$\mu$和$\sigma$分别为对数空间的均值和标准差，默认值分别为0和2。对于自然感染，峰值NAb还会根据症状严重程度进行调整：

$$\text{peak\_NAb}_{natural} = \text{peak\_NAb}_{base} \times f_{symptom} \times \text{norm\_factor}$$

其中，$f_{symptom}$为症状修正因子：无症状感染为0.85，轻症为1.0，重症为1.5。这一设计反映了症状严重程度与免疫反应强度的正相关关系。

对于**已有抗体**的个体（再次感染或接种加强针），系统会应用免疫增强（Boosting）效应：

$$\text{peak\_NAb}_{new} = \text{peak\_NAb}_{old} \times \beta_{boost}$$

其中，$\beta_{boost}$为增强因子，默认值为1.5，表示再次暴露时抗体水平会增加50%。这一机制模拟了免疫记忆的激活过程，反映了现实世界中加强针或再次感染能够显著提升抗体水平的观察结果。

#### NAb水平的动态衰减

峰值NAb设定后，抗体水平会随时间衰减。模型采用预计算的衰减动力学函数来描述这一过程。在每个时间步$t$，个体的当前NAb水平更新为：

$$\text{NAb}(t) = \text{NAb}(t-1) + \Delta\text{NAb}(t) \times \text{peak\_NAb}$$

其中，$\Delta\text{NAb}(t)$为预计算的衰减增量，$\text{peak\_NAb}$为个体的峰值NAb水平。

模型支持多种衰减函数形式，其中**NAb增长-衰减模型（nab_growth_decay）**是最复杂和真实的模型，基于Khoury等人的研究。该模型包含四个阶段：

1. **线性增长期**（$0 \leq t < t_{growth}$）：NAb水平线性增长至峰值
2. **快速指数衰减期**（$t_{growth} \leq t < t_{decay1}$）：NAb水平快速下降
3. **衰减率转换期**（$t_{decay1} \leq t < t_{decay2}$）：衰减率逐渐降低
4. **慢速指数衰减期**（$t \geq t_{decay2}$）：NAb水平缓慢下降，半衰期约为10年

数学表达为：

$$\text{NAb}(t) = \begin{cases}
\text{peak\_NAb} \times \frac{t}{t_{growth}} & \text{if } 0 \leq t < t_{growth} \\
\text{peak\_NAb} \times e^{-\lambda_1(t-t_{growth})} & \text{if } t_{growth} \leq t < t_{decay1} \\
\text{peak\_NAb} \times e^{-\lambda_1(t_{decay1}-t_{growth})} \times e^{-\lambda_2(t-t_{decay1})} & \text{if } t_{decay1} \leq t < t_{decay2} \\
\text{peak\_NAb} \times e^{-\lambda_1(t_{decay1}-t_{growth})} \times e^{-\lambda_2(t_{decay2}-t_{decay1})} \times e^{-\lambda_3(t-t_{decay2})} & \text{if } t \geq t_{decay2}
\end{cases}$$

其中，$\lambda_1$、$\lambda_2$、$\lambda_3$分别为不同阶段的衰减率。默认参数为：$t_{growth}=21$天，$\lambda_1=\ln(2)/50$（50天半衰期），$t_{decay1}=150$天，$\lambda_2=\ln(2)/250$（250天半衰期），$t_{decay2}=365$天，$\lambda_3$对应约10年半衰期。

#### 免疫保护力的计算

将NAb水平转换为实际的免疫保护力采用逻辑函数（Inverse Logit）形式，基于Khoury等人的研究。对于每个保护维度，疫苗效力（Vaccine Efficacy, VE）的计算公式为：

$$VE(\text{NAb}, \text{axis}) = \frac{\exp(\alpha) \times \text{NAb}^{\beta}}{1 + \exp(\alpha) \times \text{NAb}^{\beta}}$$

其中，$\alpha$和$\beta$为不同保护维度的参数：
- **易感性保护**：$\alpha_{inf}$、$\beta_{inf}$
- **症状保护**：$\alpha_{symp\_inf}$、$\beta_{symp\_inf}$
- **重症保护**：$\alpha_{sev\_symp}$、$\beta_{sev\_symp}$

该函数呈现S型曲线特征：当NAb水平较低时，保护力增长缓慢；当NAb水平达到中等水平时，保护力快速增长；当NAb水平较高时，保护力接近饱和。这一数学形式能够准确反映抗体水平与保护效果之间的非线性关系。

对于症状性疾病的保护，模型考虑了两层保护机制：防止感染和感染后防止出现症状。症状性疾病的边际疫苗效力计算为：

$$VE_{symp} = 1 - (1 - VE_{inf}) \times (1 - VE_{symp|inf})$$

其中，$VE_{inf}$为对感染的保护，$VE_{symp|inf}$为给定感染条件下对症状的保护。

### 交叉免疫机制

不同SARS-CoV-2变种之间可能存在交叉免疫，即感染某一变种后获得的免疫力可能对另一变种提供部分保护。模型通过交叉免疫矩阵（Cross-Immunity Matrix）来刻画这一现象。

交叉免疫矩阵$\mathbf{I}$是一个$n_v \times n_v$的矩阵，其中$n_v$为变种数量。矩阵元素$I_{ij}$表示感染变种$i$后对变种$j$的免疫保护因子（0-1之间，1表示完全保护，0表示无保护）。对角线元素$I_{ii}=1$，表示同源变种的完全保护。

在计算个体对某一变种的免疫力时，系统会考虑其既往感染的变种类型：

$$\text{effective\_NAb}_{variant\_j} = \text{NAb} \times I_{ij}$$

其中，$i$为个体既往感染的变种，$j$为当前暴露的变种。这一设计使得模型能够准确模拟变异株突破性感染的现象，即既往感染或疫苗接种提供的保护可能不足以完全防止新变种的感染。

研究表明，不同变种间的交叉免疫存在显著差异。例如，感染原始毒株后对Alpha变种可能提供约90%的保护，对Delta变种提供约80%的保护，但对Omicron变种仅提供约50%的保护。这些差异反映了病毒变异对免疫逃逸能力的影响，是模型准确预测变异株传播动态的关键因素。

### 免疫计算的完整流程

在每个仿真时间步，系统通过以下步骤计算每个个体的免疫状态：

1. **更新NAb水平**：根据预计算的衰减动力学，更新所有个体的当前NAb水平
2. **确定免疫来源**：识别个体的免疫来源（自然免疫、疫苗免疫或两者兼有）
3. **计算交叉免疫因子**：根据个体既往感染的变种和当前暴露的变种，从交叉免疫矩阵中获取保护因子
4. **计算有效NAb**：将个体的NAb水平乘以交叉免疫因子，得到对当前变种的有效NAb水平
5. **转换为保护力**：使用逻辑函数将有效NAb转换为三个保护维度的保护力
6. **应用保护效果**：在感染概率、症状概率和重症概率的计算中应用相应的保护因子

这一完整的免疫计算流程确保了模型能够准确反映免疫系统在COVID-19传播过程中的复杂作用机制，为评估疫苗接种策略、变异株传播风险以及长期免疫保护效果提供了科学的建模基础。

---

**表2 免疫机制关键参数设定**

| 参数类别 | 参数名称 | 符号 | 默认值 | 说明 |
|---------|---------|------|--------|------|
| NAb初始化 | 对数均值 | $\mu$ | 0 | 初始NAb分布的对数均值 |
| | 对数标准差 | $\sigma$ | 2 | 初始NAb分布的对数标准差 |
| NAb增强 | 增强因子 | $\beta_{boost}$ | 1.5 | 再次暴露时的NAb增强倍数 |
| 症状修正 | 无症状因子 | $f_{asymp}$ | 0.85 | 无症状感染的NAb相对水平 |
| | 轻症因子 | $f_{mild}$ | 1.0 | 轻症感染的NAb相对水平 |
| | 重症因子 | $f_{severe}$ | 1.5 | 重症感染的NAb相对水平 |
| 衰减参数 | 增长时间 | $t_{growth}$ | 21天 | NAb达到峰值的时间 |
| | 初始衰减率 | $\lambda_1$ | $\ln(2)/50$ | 快速衰减期的衰减率 |
| | 第一衰减期 | $t_{decay1}$ | 150天 | 快速衰减期持续时间 |
| | 后期衰减率 | $\lambda_2$ | $\ln(2)/250$ | 慢速衰减期的衰减率 |
| | 第二衰减期 | $t_{decay2}$ | 365天 | 慢速衰减期开始时间 |
| 保护力参数 | 易感性$\alpha$ | $\alpha_{inf}$ | 1.08 | 易感性保护的$\alpha$参数 |
| | 易感性$\beta$ | $\beta_{inf}$ | 0.967 | 易感性保护的$\beta$参数 |
| | 症状$\alpha$ | $\alpha_{symp\_inf}$ | -0.739 | 症状保护的$\alpha$参数 |
| | 症状$\beta$ | $\beta_{symp\_inf}$ | 0.038 | 症状保护的$\beta$参数 |
| | 重症$\alpha$ | $\alpha_{sev\_symp}$ | -0.014 | 重症保护的$\alpha$参数 |
| | 重症$\beta$ | $\beta_{sev\_symp}$ | 0.079 | 重症保护的$\beta$参数 |

注：参数值基于Khoury等人[19]的研究，该研究建立了中和抗体水平与疫苗效力之间的定量关系。
