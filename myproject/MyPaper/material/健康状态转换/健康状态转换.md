Covasim äººå‘˜å¥åº·çŠ¶æ€è½¬æ¢æœºåˆ¶è¯¦è§£
ğŸ“– ç›®å½•
1. çŠ¶æ€æ¦‚è¿°
2. çŠ¶æ€è½¬æ¢æµç¨‹å›¾
3. æ¯ä¸ªçŠ¶æ€çš„è¯¦ç»†è¯´æ˜
4. çŠ¶æ€è½¬æ¢æ¡ä»¶
5. æ ¸å¿ƒè½¬æ¢å‡½æ•°
6. ç–¾ç—…è¿›å±•è·¯å¾„
7. å¹²é¢„æªæ–½ç›¸å…³çŠ¶æ€
8. æ—¶é—´å‚æ•°
9. å®Œæ•´ç¤ºä¾‹
10. å¸¸è§é—®é¢˜

1. çŠ¶æ€æ¦‚è¿°
1.1 æ‰€æœ‰å¥åº·çŠ¶æ€
åœ¨ Covasim ä¸­ï¼Œæ¯ä¸ªäººå¯ä»¥å¤„äºä»¥ä¸‹ 16 ç§çŠ¶æ€ï¼ˆéƒ½æ˜¯å¸ƒå°”å€¼ï¼‰ï¼š
self.states = [
    'susceptible',      # æ˜“æ„Ÿè€…
    'naive',            # æœªæ¥è§¦è¿‡ç—…æ¯’/ç–«è‹—çš„äºº
    'exposed',          # æš´éœ²è€…ï¼ˆå·²æ„ŸæŸ“ä½†å°šæœªä¼ æŸ“ï¼‰
    'infectious',       # ä¼ æŸ“è€…ï¼ˆå¯ä»¥ä¼ æŸ“ä»–äººï¼‰
    'symptomatic',      # æœ‰ç—‡çŠ¶è€…
    'severe',           # é‡ç—‡æ‚£è€…
    'critical',         # å±é‡ç—‡æ‚£è€…
    'tested',           # å·²æ£€æµ‹è€…
    'diagnosed',        # å·²è¯Šæ–­è€…
    'recovered',        # åº·å¤è€…
    'known_dead',       # å·²çŸ¥æ­»äº¡ï¼ˆå·²è¯Šæ–­åæ­»äº¡ï¼‰
    'dead',             # æ­»äº¡
    'known_contact',    # å·²çŸ¥æ¥è§¦è€…
    'quarantined',      # éš”ç¦»ä¸­
    'isolated',         # éš”ç¦»ä¸­ï¼ˆè¯Šæ–­åï¼‰
    'vaccinated',       # å·²æ¥ç§ç–«è‹—
]
1.2 çŠ¶æ€åˆ†ç±»
ç–¾ç—…ç›¸å…³çŠ¶æ€ï¼ˆDisease Statesï¼‰
susceptible â†’ exposed â†’ infectious â†’ [symptomatic] â†’ recovered
                                   â†“
                            [severe] â†’ [critical] â†’ dead
æ£€æµ‹ç›¸å…³çŠ¶æ€ï¼ˆTesting Statesï¼‰
tested â†’ diagnosed
å¹²é¢„ç›¸å…³çŠ¶æ€ï¼ˆIntervention Statesï¼‰
known_contact â†’ quarantined
diagnosed â†’ isolated
vaccinated
ç‰¹æ®ŠçŠ¶æ€
â— naive: ä»æœªæ¥è§¦è¿‡ç—…æ¯’æˆ–ç–«è‹—çš„"å¤©çœŸ"çŠ¶æ€
â— known_dead: å·²çŸ¥æ­»äº¡ï¼ˆå·²è¯Šæ–­çš„æ­»äº¡ç—…ä¾‹ï¼‰
â— dead: æ‰€æœ‰æ­»äº¡ç—…ä¾‹

2. çŠ¶æ€è½¬æ¢æµç¨‹å›¾
2.1 å®Œæ•´ç–¾ç—…è¿›å±•æµç¨‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ susceptible  â”‚  åˆå§‹çŠ¶æ€ï¼šæ˜“æ„Ÿè€…ï¼ˆé»˜è®¤æ‰€æœ‰äººï¼‰
â”‚   + naive    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ æ„ŸæŸ“äº‹ä»¶ï¼ˆæ¥è§¦ä¼ æŸ“æºï¼‰
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   exposed    â”‚  æš´éœ²æœŸï¼šå·²æ„ŸæŸ“ä½†ä¸ä¼ æŸ“
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ dur_exp2inf å¤©å
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ infectious   â”‚  ä¼ æŸ“æœŸï¼šå¼€å§‹å¯ä»¥ä¼ æŸ“ä»–äºº
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ æ— ç—‡çŠ¶è·¯å¾„ (70-80%)
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚ asymptomatic â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚          â”‚ dur_asym2rec å¤©å
       â”‚          â†“
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚  recovered   â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â†’ æœ‰ç—‡çŠ¶è·¯å¾„ (20-30%)
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ symptomatic  â”‚  å‡ºç°ç—‡çŠ¶
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”œâ”€â†’ è½»ç—‡è·¯å¾„ (å¤§éƒ¨åˆ†)
                  â”‚   â””â†’ dur_mild2rec å¤©å â†’ recovered
                  â”‚
                  â””â”€â†’ é‡ç—‡è·¯å¾„ (å°‘æ•°)
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   severe     â”‚  éœ€è¦ä½é™¢
                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”œâ”€â†’ éå±é‡ (å¤§éƒ¨åˆ†)
                             â”‚   â””â†’ dur_sev2rec å¤©å â†’ recovered
                             â”‚
                             â””â”€â†’ å±é‡è·¯å¾„ (å°‘æ•°)
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  critical    â”‚  éœ€è¦ICU
                                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”œâ”€â†’ å­˜æ´» (å¤§éƒ¨åˆ†)
                                        â”‚   â””â†’ dur_crit2rec å¤©å â†’ recovered
                                        â”‚
                                        â””â”€â†’ æ­»äº¡ (å°‘æ•°)
                                            â””â†’ dur_crit2die å¤©å â†’ dead
2.2 æ£€æµ‹å’Œè¯Šæ–­æµç¨‹
ä»»ä½•çŠ¶æ€
    â†“ æ¥å—æ£€æµ‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   tested     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ å¦‚æœ infectious + æµ‹è¯•é˜³æ€§
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  diagnosed   â”‚  test_delay å¤©åç¡®è¯Š
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  isolated    â”‚  è¿›å…¥éš”ç¦»çŠ¶æ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2.3 æ¥è§¦è¿½è¸ªæµç¨‹
diagnosed
    â†“ è¿½è¸ªæ¥è§¦è€…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚known_contact â”‚  è¢«è¯†åˆ«ä¸ºæ¥è§¦è€…
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ quarantined  â”‚  è¿›å…¥éš”ç¦»ï¼ˆquar_period å¤©ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. æ¯ä¸ªçŠ¶æ€çš„è¯¦ç»†è¯´æ˜
3.1 susceptibleï¼ˆæ˜“æ„Ÿè€…ï¼‰
å®šä¹‰: å¯ä»¥è¢«æ„ŸæŸ“çš„äºº
åˆå§‹å€¼: Trueï¼ˆæ‰€æœ‰äººé»˜è®¤æ˜“æ„Ÿï¼‰
ä½•æ—¶å˜ä¸º True:
â— æ¨¡æ‹Ÿå¼€å§‹æ—¶ï¼ˆé»˜è®¤ï¼‰
â— ä½¿ç”¨å…ç–«è¡°å‡æ—¶ï¼Œåº·å¤åé‡æ–°å˜ä¸ºæ˜“æ„Ÿ
ä½•æ—¶å˜ä¸º False:
â— è¢«æ„ŸæŸ“æ—¶ï¼ˆexposed å˜ä¸º Trueï¼‰
â— æ­»äº¡æ—¶
é‡è¦æ€§: åªæœ‰ susceptible=True çš„äººæ‰èƒ½è¢«æ„ŸæŸ“

3.2 naiveï¼ˆå¤©çœŸè€…/æœªæ¥è§¦è€…ï¼‰
å®šä¹‰: ä»æœªæ¥è§¦è¿‡ç—…æ¯’æˆ–ç–«è‹—çš„äºº
åˆå§‹å€¼: Trueï¼ˆæ‰€æœ‰äººé»˜è®¤æœªæ¥è§¦ï¼‰
ä½•æ—¶å˜ä¸º False:
â— é¦–æ¬¡æ„ŸæŸ“æ—¶
â— æ¥ç§ç–«è‹—æ—¶
ç”¨é€”: ç”¨äºè¿½è¸ªäººç¾¤ä¸­çš„å…ç–«å†å²

3.3 exposedï¼ˆæš´éœ²è€…ï¼‰
å®šä¹‰: å·²è¢«æ„ŸæŸ“ï¼Œä½†å°šä¸èƒ½ä¼ æŸ“ä»–äººï¼ˆæ½œä¼æœŸï¼‰
è½¬æ¢æ¡ä»¶:
# åœ¨ infect() æ–¹æ³•ä¸­è®¾ç½®
self.exposed[inds] = True
self.date_exposed[inds] = self.t
æŒç»­æ—¶é—´: dur_exp2inf å¤©ï¼ˆä»æš´éœ²åˆ°ä¼ æŸ“ï¼‰
ä¸‹ä¸€çŠ¶æ€: infectiousï¼ˆä¼ æŸ“æœŸï¼‰
ä½•æ—¶ç»“æŸ:
â— è¿›å…¥ infectious çŠ¶æ€
â— åº·å¤æ—¶é‡ç½®
â— æ­»äº¡æ—¶é‡ç½®

3.4 infectiousï¼ˆä¼ æŸ“è€…ï¼‰
å®šä¹‰: å¯ä»¥ä¼ æŸ“ä»–äººçš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ check_infectious() ä¸­
if self.t >= self.date_infectious[ind]:
    self.infectious[ind] = True
è½¬æ¢æ—¶æœº: 
date_infectious = date_exposed + dur_exp2inf
ä¸‹ä¸€çŠ¶æ€: 
â— å¯èƒ½åŒæ—¶è¿›å…¥ symptomaticï¼ˆæœ‰ç—‡çŠ¶ï¼‰
â— æˆ–ä¿æŒæ— ç—‡çŠ¶ç›´è‡³ recovered
ä½•æ—¶ç»“æŸ:
â— åº·å¤æ—¶ï¼ˆrecoveredï¼‰
â— æ­»äº¡æ—¶ï¼ˆdeadï¼‰

3.5 symptomaticï¼ˆæœ‰ç—‡çŠ¶è€…ï¼‰
å®šä¹‰: å‡ºç° COVID-19 ç—‡çŠ¶çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ infect() ä¸­æ ¹æ®æ¦‚ç‡ç¡®å®š
symp_probs = rel_symp_prob * self.symp_prob[inds] * (1 - self.symp_imm[variant, inds])
is_symp = cvu.binomial_arr(symp_probs)

# åœ¨ check_symptomatic() ä¸­è®¾ç½®çŠ¶æ€
if self.t >= self.date_symptomatic[ind]:
    self.symptomatic[ind] = True
è½¬æ¢æ—¶æœº:
date_symptomatic = date_infectious + dur_inf2sym
å½±å“å› ç´ :
â— å¹´é¾„ï¼ˆè€å¹´äººæ›´å¯èƒ½æœ‰ç—‡çŠ¶ï¼‰
â— å…ç–«çŠ¶æ€ï¼ˆæœ‰å…ç–«çš„äººç—‡çŠ¶æ¦‚ç‡é™ä½ï¼‰
â— å˜ç§ç‰¹æ€§ï¼ˆä¸åŒå˜ç§ç—‡çŠ¶æ¦‚ç‡ä¸åŒï¼‰
æ¦‚ç‡:
â— å„¿ç«¥: ~20-40%
â— æˆäºº: ~50-70%
â— è€å¹´äºº: ~70-90%
ä¸‹ä¸€çŠ¶æ€:
â— è½»ç—‡ â†’ recovered
â— é‡ç—‡ â†’ severe

3.6 severeï¼ˆé‡ç—‡æ‚£è€…ï¼‰
å®šä¹‰: éœ€è¦ä½é™¢æ²»ç–—çš„é‡ç—‡æ‚£è€…
è½¬æ¢æ¡ä»¶:
# åœ¨ infect() ä¸­æ ¹æ®æ¦‚ç‡ç¡®å®š
sev_probs = rel_severe_prob * self.severe_prob[symp_inds] * (1 - self.sev_imm[variant, symp_inds])
is_sev = cvu.binomial_arr(sev_probs)

# åœ¨ check_severe() ä¸­è®¾ç½®çŠ¶æ€
if self.t >= self.date_severe[ind]:
    self.severe[ind] = True
è½¬æ¢æ—¶æœº:
date_severe = date_symptomatic + dur_sym2sev
å½±å“å› ç´ :
â— å¹´é¾„ï¼ˆè€å¹´äººé‡ç—‡ç‡é«˜ï¼‰
â— åŸºç¡€ç–¾ç—…ï¼ˆcomorbiditiesï¼‰
â— åŒ»é™¢åºŠä½ï¼ˆåºŠä½ä¸è¶³æ—¶é‡ç—‡ç‡ä¸Šå‡ï¼‰
æ¦‚ç‡ï¼ˆåœ¨æœ‰ç—‡çŠ¶è€…ä¸­ï¼‰:
â— é’å¹´: ~1-5%
â— ä¸­å¹´: ~5-15%
â— è€å¹´: ~15-30%
ä¸‹ä¸€çŠ¶æ€:
â— éå±é‡ â†’ recovered
â— å±é‡ â†’ critical

3.7 criticalï¼ˆå±é‡ç—‡æ‚£è€…ï¼‰
å®šä¹‰: éœ€è¦ ICU æ²»ç–—çš„å±é‡ç—‡æ‚£è€…
è½¬æ¢æ¡ä»¶:
# åœ¨ infect() ä¸­æ ¹æ®æ¦‚ç‡ç¡®å®š
crit_probs = rel_crit_prob * self.crit_prob[sev_inds] * (no_hosp_factor if hosp_max else 1.0)
is_crit = cvu.binomial_arr(crit_probs)

# åœ¨ check_critical() ä¸­è®¾ç½®çŠ¶æ€
if self.t >= self.date_critical[ind]:
    self.critical[ind] = True
è½¬æ¢æ—¶æœº:
date_critical = date_severe + dur_sev2crit
å½±å“å› ç´ :
â— å¹´é¾„ï¼ˆè€å¹´äººå±é‡ç‡é«˜ï¼‰
â— ICUåºŠä½ï¼ˆåºŠä½ä¸è¶³æ—¶æ­»äº¡ç‡ä¸Šå‡ï¼‰
æ¦‚ç‡ï¼ˆåœ¨é‡ç—‡æ‚£è€…ä¸­ï¼‰:
â— é’å¹´: ~5-10%
â— ä¸­å¹´: ~10-20%
â— è€å¹´: ~20-40%
ä¸‹ä¸€çŠ¶æ€:
â— å­˜æ´» â†’ recovered
â— æ­»äº¡ â†’ dead

3.8 testedï¼ˆå·²æ£€æµ‹è€…ï¼‰
å®šä¹‰: æ¥å—è¿‡ COVID-19 æ£€æµ‹çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ test() æ–¹æ³•ä¸­
self.tested[inds] = True
self.date_tested[inds] = self.t
è§¦å‘æ–¹å¼:
â— å¹²é¢„æªæ–½ï¼šcv.test_prob() æˆ– cv.test_num()
â— æœ‰ç—‡çŠ¶æ—¶æŒ‰ä¸€å®šæ¦‚ç‡æ£€æµ‹
â— æ¥è§¦è€…è¿½è¸ªæ—¶æ£€æµ‹
æ³¨æ„: tested ä¸ç­‰äºé˜³æ€§ï¼Œåªè¡¨ç¤ºæ¥å—è¿‡æ£€æµ‹

3.9 diagnosedï¼ˆå·²è¯Šæ–­è€…ï¼‰
å®šä¹‰: è¢«è¯Šæ–­ä¸º COVID-19 é˜³æ€§çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ test() æ–¹æ³•ä¸­
if infectious and test_positive:
    self.date_diagnosed[inds] = self.t + test_delay

# åœ¨ check_diagnosed() ä¸­
if self.t >= self.date_diagnosed[ind]:
    self.diagnosed[ind] = True
è¦æ±‚:
1. å¿…é¡»æ˜¯ infectiousï¼ˆä¼ æŸ“æœŸï¼‰
2. æµ‹è¯•ç»“æœä¸ºé˜³æ€§ï¼ˆè€ƒè™‘çµæ•åº¦ï¼‰
3. æœªå¤±è®¿ï¼ˆloss to follow-upï¼‰
å½±å“:
â— è‡ªåŠ¨è¿›å…¥ isolated çŠ¶æ€
â— å¯èƒ½è§¦å‘æ¥è§¦è€…è¿½è¸ª
â— å¦‚æœæ­»äº¡ï¼Œä¼šè®°å½•ä¸º known_dead

3.10 recoveredï¼ˆåº·å¤è€…ï¼‰
å®šä¹‰: ä» COVID-19 åº·å¤çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ check_recovery() ä¸­
if self.t >= self.date_recovered[ind]:
    self.recovered[ind] = True
    # é‡ç½®æ‰€æœ‰ç–¾ç—…çŠ¶æ€
    self.exposed[ind] = False
    self.infectious[ind] = False
    self.symptomatic[ind] = False
    self.severe[ind] = False
    self.critical[ind] = False
åº·å¤æ—¶é—´ï¼ˆä»æš´éœ²å¼€å§‹ï¼‰:
â— æ— ç—‡çŠ¶: çº¦ 7-14 å¤©
â— è½»ç—‡: çº¦ 14-21 å¤©
â— é‡ç—‡: çº¦ 21-35 å¤©
â— å±é‡: çº¦ 35-56 å¤©
åº·å¤å:
â— ä¸å†ä¼ æŸ“ä»–äºº
â— è·å¾—å…ç–«ï¼ˆå¦‚æœä½¿ç”¨ use_waning=Trueï¼‰
â— å¦‚æœå…ç–«è¡°å‡ï¼Œå¯èƒ½é‡æ–°å˜ä¸º susceptible

3.11 deadï¼ˆæ­»äº¡ï¼‰
å®šä¹‰: å›  COVID-19 æ­»äº¡çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ infect() ä¸­ç¡®å®šæ­»äº¡æ¦‚ç‡
death_probs = rel_death_prob * self.death_prob[crit_inds] * (no_icu_factor if icu_max else 1.0)
is_dead = cvu.binomial_arr(death_probs)
self.date_dead[dead_inds] = date_critical + dur_crit2die

# åœ¨ check_death() ä¸­
if self.t >= self.date_dead[ind]:
    self.dead[ind] = True
    # é‡ç½®æ‰€æœ‰å…¶ä»–çŠ¶æ€
ä½•æ—¶å‘ç”Ÿ:
â— åªæœ‰ critical çŠ¶æ€çš„äººå¯èƒ½æ­»äº¡
â— åœ¨è¾¾åˆ° date_dead æ—¶å‘ç”Ÿ
æ¦‚ç‡ï¼ˆåœ¨å±é‡æ‚£è€…ä¸­ï¼‰:
â— é’å¹´: ~5-20%
â— ä¸­å¹´: ~20-40%
â— è€å¹´: ~40-70%
å½±å“:
â— æ‰€æœ‰å…¶ä»–ç–¾ç—…çŠ¶æ€é‡ç½®ä¸º False
â— å¦‚æœä¹‹å‰è¢«è¯Šæ–­ï¼Œåˆ™ known_dead = True

3.12 known_deadï¼ˆå·²çŸ¥æ­»äº¡ï¼‰
å®šä¹‰: è¢«è¯Šæ–­åæ­»äº¡çš„ç—…ä¾‹
è½¬æ¢æ¡ä»¶:
# åœ¨ check_death() ä¸­
if self.diagnosed[ind] and self.dead[ind]:
    self.known_dead[ind] = True
ç”¨é€”: ç”¨äºç»Ÿè®¡å·²çŸ¥çš„æ­»äº¡ç—…ä¾‹æ•°ï¼ˆå®˜æ–¹æŠ¥å‘Šçš„æ­»äº¡æ•°ï¼‰

3.13 known_contactï¼ˆå·²çŸ¥æ¥è§¦è€…ï¼‰
å®šä¹‰: è¢«è¯†åˆ«ä¸ºç¡®è¯Šç—…ä¾‹æ¥è§¦è€…çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨æ¥è§¦è€…è¿½è¸ªå¹²é¢„ä¸­è®¾ç½®
# å½“æŸäººè¢«è¯Šæ–­æ—¶ï¼Œè¿½è¸ªå…¶æ¥è§¦è€…
self.known_contact[contact_inds] = True
self.date_known_contact[contact_inds] = self.t
è§¦å‘æ–¹å¼:
â— ä½¿ç”¨ cv.contact_tracing() å¹²é¢„æªæ–½
â— ç¡®è¯Šç—…ä¾‹çš„æ¥è§¦è€…è¢«è¿½è¸ª
ä¸‹ä¸€æ­¥: é€šå¸¸ä¼šè¢«è¦æ±‚éš”ç¦»ï¼ˆquarantinedï¼‰

3.14 quarantinedï¼ˆéš”ç¦»ä¸­ï¼‰
å®šä¹‰: å› æ¥è§¦è¿½è¸ªè€Œè¢«éš”ç¦»çš„äººï¼ˆæœªç¡®è¯Šï¼‰
è½¬æ¢æ¡ä»¶:
# åœ¨ schedule_quarantine() å’Œ check_quar() ä¸­
if not (dead or recovered or diagnosed or isolated):
    self.quarantined[ind] = True
    self.date_quarantined[ind] = self.t
    self.date_end_quarantine[ind] = self.t + quar_period
ä½•æ—¶è¿›å…¥:
â— è¢«è¯†åˆ«ä¸ºæ¥è§¦è€…
â— æœªè¢«è¯Šæ–­ï¼ˆè¯Šæ–­åè¿›å…¥ isolatedï¼‰
ä½•æ—¶ç»“æŸ:
if self.t >= self.date_end_quarantine[ind]:
    self.quarantined[ind] = False
æŒç»­æ—¶é—´: quar_period å¤©ï¼ˆé»˜è®¤14å¤©ï¼‰
æ³¨æ„: 
â— å¦‚æœåœ¨éš”ç¦»æœŸé—´è¢«è¯Šæ–­ï¼Œç«‹å³ç»“æŸéš”ç¦»ï¼Œè¿›å…¥ isolated
â— éš”ç¦»ä¼šé™ä½ä¼ æ’­ï¼ˆé€šè¿‡å‡å°‘æ¥è§¦ï¼‰

3.15 isolatedï¼ˆéš”ç¦»ä¸­-å·²è¯Šæ–­ï¼‰
å®šä¹‰: è¢«è¯Šæ–­åè¿›è¡Œçš„éš”ç¦»
è½¬æ¢æ¡ä»¶:
# åœ¨ check_enter_iso() ä¸­
if self.date_diagnosed[ind] == self.t:
    self.isolated[ind] = True
    self.date_end_isolation[ind] = self.date_recovered[ind]
ä¸ quarantined çš„åŒºåˆ«:
â— quarantined: ç–‘ä¼¼æ¥è§¦è€…çš„é¢„é˜²æ€§éš”ç¦»
â— isolated: ç¡®è¯Šç—…ä¾‹çš„æ²»ç–—æ€§éš”ç¦»
ä½•æ—¶ç»“æŸ:
if self.t >= self.date_end_isolation[ind]:
    self.isolated[ind] = False
æŒç»­æ—¶é—´: ç›´åˆ°åº·å¤ï¼ˆdate_recoveredï¼‰

3.16 vaccinatedï¼ˆå·²æ¥ç§ç–«è‹—ï¼‰
å®šä¹‰: æ¥ç§è¿‡ COVID-19 ç–«è‹—çš„äºº
è½¬æ¢æ¡ä»¶:
# åœ¨ç–«è‹—å¹²é¢„ä¸­è®¾ç½®
self.vaccinated[inds] = True
self.date_vaccinated[inds] = self.t
è§¦å‘æ–¹å¼:
â— ä½¿ç”¨ cv.vaccinate_prob() æˆ– cv.vaccinate_num() å¹²é¢„
å½±å“:
â— é™ä½æ˜“æ„Ÿæ€§ï¼ˆrel_susï¼‰
â— é™ä½ç—‡çŠ¶æ¦‚ç‡ï¼ˆé€šè¿‡ symp_immï¼‰
â— é™ä½é‡ç—‡æ¦‚ç‡ï¼ˆé€šè¿‡ sev_immï¼‰
â— å¢åŠ ä¸­å’ŒæŠ—ä½“ï¼ˆnabï¼‰
æ³¨æ„: 
â— ç–«è‹—ä¸èƒ½é˜»æ­¢æ‰€æœ‰æ„ŸæŸ“ï¼ˆçªç ´æ€§æ„ŸæŸ“ï¼‰
â— å…ç–«æ•ˆæœä¼šéšæ—¶é—´è¡°å‡

4. çŠ¶æ€è½¬æ¢æ¡ä»¶
4.1 æ—¶é—´é©±åŠ¨çš„è½¬æ¢
å¤§éƒ¨åˆ†çŠ¶æ€è½¬æ¢ç”±æ—¶é—´é©±åŠ¨ï¼Œä½¿ç”¨ check_inds() æ–¹æ³•ï¼š
def check_inds(self, current, date, filter_inds=None):
    '''
    è¿”å›æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„äººçš„ç´¢å¼•ï¼š
    1. å½“å‰çŠ¶æ€ä¸º False
    2. å·²ç»åˆ°è¾¾æŒ‡å®šæ—¥æœŸ
    '''
    if filter_inds is None:
        not_current = cvu.false(current)  # æ‰¾åˆ°å½“å‰çŠ¶æ€ä¸ºFalseçš„äºº
    else:
        not_current = cvu.ifalsei(current, filter_inds)  # åœ¨æŒ‡å®šèŒƒå›´å†…æŸ¥æ‰¾
    
    has_date = cvu.idefinedi(date, not_current)  # æ‰¾åˆ°æœ‰æ—¥æœŸçš„äºº
    inds = cvu.itrue(self.t >= date[has_date], has_date)  # æ‰¾åˆ°å·²åˆ°æ—¥æœŸçš„äºº
    
    return inds
åº”ç”¨ç¤ºä¾‹:
def check_infectious(self):
    '''å½“ t >= date_infectious æ—¶ï¼Œå˜ä¸º infectious'''
    inds = self.check_inds(self.infectious, self.date_infectious, filter_inds=self.is_exp)
    self.infectious[inds] = True
    return inds
4.2 æ¦‚ç‡é©±åŠ¨çš„è½¬æ¢
æŸäº›è½¬æ¢ç”±æ¦‚ç‡å†³å®šï¼ˆåœ¨ infect() æ–¹æ³•ä¸­ï¼‰ï¼š
# 1. æ˜¯å¦æœ‰ç—‡çŠ¶ï¼Ÿ
symp_probs = rel_symp_prob * self.symp_prob[inds] * (1 - self.symp_imm[variant, inds])
is_symp = cvu.binomial_arr(symp_probs)  # äºŒé¡¹åˆ†å¸ƒé‡‡æ ·

# 2. æ˜¯å¦é‡ç—‡ï¼Ÿï¼ˆåœ¨æœ‰ç—‡çŠ¶è€…ä¸­ï¼‰
sev_probs = rel_severe_prob * self.severe_prob[symp_inds] * (1 - self.sev_imm[variant, symp_inds])
is_sev = cvu.binomial_arr(sev_probs)

# 3. æ˜¯å¦å±é‡ï¼Ÿï¼ˆåœ¨é‡ç—‡è€…ä¸­ï¼‰
crit_probs = rel_crit_prob * self.crit_prob[sev_inds] * (no_hosp_factor if hosp_max else 1.0)
is_crit = cvu.binomial_arr(crit_probs)

# 4. æ˜¯å¦æ­»äº¡ï¼Ÿï¼ˆåœ¨å±é‡è€…ä¸­ï¼‰
death_probs = rel_death_prob * self.death_prob[crit_inds] * (no_icu_factor if icu_max else 1.0)
is_dead = cvu.binomial_arr(death_probs)
4.3 äº‹ä»¶é©±åŠ¨çš„è½¬æ¢
æŸäº›è½¬æ¢ç”±å¤–éƒ¨äº‹ä»¶è§¦å‘ï¼š
# æµ‹è¯• â†’ è¯Šæ–­
people.test(inds, test_sensitivity=0.9, test_delay=2)

# æ¥è§¦è€… â†’ éš”ç¦»
people.schedule_quarantine(inds, period=14)

# ç–«è‹—æ¥ç§
people.vaccinated[inds] = True

5. æ ¸å¿ƒè½¬æ¢å‡½æ•°
5.1 update_states_pre() - ä¸»è¦çŠ¶æ€æ›´æ–°
åœ¨æ¯ä¸ªæ—¶é—´æ­¥å¼€å§‹æ—¶è°ƒç”¨ï¼š
def update_states_pre(self, t):
    '''æ‰§è¡Œæ‰€æœ‰çŠ¶æ€æ›´æ–°'''
    self.t = t
    self.is_exp = self.true('exposed')  # ç¼“å­˜æš´éœ²è€…ç´¢å¼•
    
    # åˆå§‹åŒ–æµé‡è®¡æ•°
    self.init_flows()
    
    # æŒ‰é¡ºåºæ£€æŸ¥çŠ¶æ€è½¬æ¢
    self.flows['new_infectious']  += len(self.check_infectious())
    self.flows['new_symptomatic'] += len(self.check_symptomatic())
    self.flows['new_severe']      += len(self.check_severe())
    self.flows['new_critical']    += len(self.check_critical())
    self.flows['new_recoveries']  += len(self.check_recovery())
    
    # æ£€æŸ¥éš”ç¦»ç»“æŸ
    self.check_exit_iso()
    
    # æ£€æŸ¥æ­»äº¡
    _, new_deaths, new_known_deaths = self.check_death()
    self.flows['new_deaths']       += new_deaths
    self.flows['new_known_deaths'] += new_known_deaths
    
    # æ›´æ–°å…ç–«
    if self.pars['use_waning']:
        cvi.check_immunity(self)
    
    return
5.2 update_states_post() - åç»­çŠ¶æ€æ›´æ–°
åœ¨ä¼ æ’­è®¡ç®—åè°ƒç”¨ï¼š
def update_states_post(self):
    '''æ‰§è¡Œåç»­æ›´æ–°ï¼ˆè¯Šæ–­ã€éš”ç¦»ï¼‰'''
    self.flows['new_diagnoses']   += len(self.check_diagnosed())
    self.flows['new_quarantined'] += self.check_quar()
    self.flows['new_isolated']    += len(self.check_enter_iso())
    return
5.3 infect() - æ„ŸæŸ“å¹¶ç¡®å®šé¢„å
è¿™æ˜¯æœ€æ ¸å¿ƒçš„å‡½æ•°ï¼Œç¡®å®šæ„ŸæŸ“è€…çš„æ•´ä¸ªç–¾ç—…å†ç¨‹ï¼š
def infect(self, inds, source=None, layer=None, variant=0):
    '''
    æ„ŸæŸ“äººå¹¶ç¡®å®šä»–ä»¬çš„æœ€ç»ˆç»“æœ
    
    æµç¨‹ï¼š
    1. è®¾ç½® exposed çŠ¶æ€
    2. ç¡®å®šç—‡çŠ¶è·¯å¾„ï¼ˆæœ‰ç—‡çŠ¶ vs æ— ç—‡çŠ¶ï¼‰
    3. å¯¹æœ‰ç—‡çŠ¶è€…ï¼Œç¡®å®šä¸¥é‡ç¨‹åº¦ï¼ˆè½»ç—‡/é‡ç—‡/å±é‡ï¼‰
    4. å¯¹å±é‡è€…ï¼Œç¡®å®šç»“æœï¼ˆåº·å¤/æ­»äº¡ï¼‰
    5. ä¸ºæ¯ä¸ªé˜¶æ®µè®¾ç½®æ—¥æœŸ
    6. æ›´æ–°å…ç–«å’ŒæŠ—ä½“
    '''
    
    # åªæ„ŸæŸ“æ˜“æ„Ÿè€…
    keep = self.susceptible[inds]
    inds = inds[keep]
    
    # æ›´æ–°åŸºæœ¬çŠ¶æ€
    self.susceptible[inds] = False
    self.naive[inds] = False
    self.exposed[inds] = True
    self.date_exposed[inds] = self.t
    
    # è®¡ç®—ä¼ æŸ“æœŸå¼€å§‹æ—¶é—´
    self.dur_exp2inf[inds] = cvu.sample(**durpars['exp2inf'], size=n_infections)
    self.date_infectious[inds] = self.dur_exp2inf[inds] + self.t
    
    # ç¡®å®šæ˜¯å¦æœ‰ç—‡çŠ¶
    symp_probs = rel_symp_prob * self.symp_prob[inds] * (1 - self.symp_imm[variant, inds])
    is_symp = cvu.binomial_arr(symp_probs)
    
    # æ— ç—‡çŠ¶è·¯å¾„
    asymp_inds = inds[~is_symp]
    dur_asym2rec = cvu.sample(**durpars['asym2rec'], size=len(asymp_inds))
    self.date_recovered[asymp_inds] = self.date_infectious[asymp_inds] + dur_asym2rec
    
    # æœ‰ç—‡çŠ¶è·¯å¾„
    symp_inds = inds[is_symp]
    self.dur_inf2sym[symp_inds] = cvu.sample(**durpars['inf2sym'], size=len(symp_inds))
    self.date_symptomatic[symp_inds] = self.date_infectious[symp_inds] + self.dur_inf2sym[symp_inds]
    
    # ç¡®å®šé‡ç—‡
    sev_probs = rel_severe_prob * self.severe_prob[symp_inds] * (1 - self.sev_imm[variant, symp_inds])
    is_sev = cvu.binomial_arr(sev_probs)
    
    # è½»ç—‡è·¯å¾„
    mild_inds = symp_inds[~is_sev]
    dur_mild2rec = cvu.sample(**durpars['mild2rec'], size=len(mild_inds))
    self.date_recovered[mild_inds] = self.date_symptomatic[mild_inds] + dur_mild2rec
    
    # é‡ç—‡è·¯å¾„
    sev_inds = symp_inds[is_sev]
    self.dur_sym2sev[sev_inds] = cvu.sample(**durpars['sym2sev'], size=len(sev_inds))
    self.date_severe[sev_inds] = self.date_symptomatic[sev_inds] + self.dur_sym2sev[sev_inds]
    
    # ç¡®å®šå±é‡
    crit_probs = rel_crit_prob * self.crit_prob[sev_inds]
    is_crit = cvu.binomial_arr(crit_probs)
    
    # éå±é‡é‡ç—‡
    non_crit_inds = sev_inds[~is_crit]
    dur_sev2rec = cvu.sample(**durpars['sev2rec'], size=len(non_crit_inds))
    self.date_recovered[non_crit_inds] = self.date_severe[non_crit_inds] + dur_sev2rec
    
    # å±é‡è·¯å¾„
    crit_inds = sev_inds[is_crit]
    self.dur_sev2crit[crit_inds] = cvu.sample(**durpars['sev2crit'], size=len(crit_inds))
    self.date_critical[crit_inds] = self.date_severe[crit_inds] + self.dur_sev2crit[crit_inds]
    
    # ç¡®å®šæ­»äº¡
    death_probs = rel_death_prob * self.death_prob[crit_inds]
    is_dead = cvu.binomial_arr(death_probs)
    
    # å­˜æ´»çš„å±é‡è€…
    alive_inds = crit_inds[~is_dead]
    dur_crit2rec = cvu.sample(**durpars['crit2rec'], size=len(alive_inds))
    self.date_recovered[alive_inds] = self.date_critical[alive_inds] + dur_crit2rec
    
    # æ­»äº¡çš„å±é‡è€…
    dead_inds = crit_inds[is_dead]
    dur_crit2die = cvu.sample(**durpars['crit2die'], size=len(dead_inds))
    self.date_dead[dead_inds] = self.date_critical[dead_inds] + dur_crit2die
    
    # æ›´æ–°å…ç–«
    if self.pars['use_waning']:
        symp = dict(asymp=asymp_inds, mild=mild_inds, sev=sev_inds)
        cvi.update_peak_nab(self, inds, nab_pars=self.pars, symp=symp)
    
    return inds

6. ç–¾ç—…è¿›å±•è·¯å¾„
6.1 è·¯å¾„1ï¼šæ— ç—‡çŠ¶æ„ŸæŸ“ï¼ˆAsymptomaticï¼‰
susceptible â†’ exposed â†’ infectious â†’ recovered
    (day 0)     (day 1)   (day 3)      (day 10)
æ¯”ä¾‹: çº¦ 30-50%
æ—¶é—´çº¿:
â— Day 0: æ„ŸæŸ“ï¼ˆexposedï¼‰
â— Day 1-3: æš´éœ²æœŸï¼ˆdur_exp2inf â‰ˆ 1-3å¤©ï¼‰
â— Day 3: å¼€å§‹ä¼ æŸ“ï¼ˆinfectiousï¼‰
â— Day 3-10: ä¼ æŸ“æœŸä½†æ— ç—‡çŠ¶ï¼ˆdur_asym2rec â‰ˆ 7å¤©ï¼‰
â— Day 10: åº·å¤ï¼ˆrecoveredï¼‰
ä»£ç :
# åœ¨ infect() ä¸­
asymp_inds = inds[~is_symp]
dur_asym2rec = cvu.sample(dist='lognormal', par1=8, par2=2, size=len(asymp_inds))
self.date_recovered[asymp_inds] = self.date_infectious[asymp_inds] + dur_asym2rec

6.2 è·¯å¾„2ï¼šè½»ç—‡ï¼ˆMildï¼‰
susceptible â†’ exposed â†’ infectious â†’ symptomatic â†’ recovered
    (day 0)     (day 1)   (day 3)      (day 8)      (day 18)
æ¯”ä¾‹: çº¦ 40-60%ï¼ˆåœ¨æ‰€æœ‰æ„ŸæŸ“ä¸­ï¼‰
æ—¶é—´çº¿:
â— Day 0: æ„ŸæŸ“
â— Day 3: å¼€å§‹ä¼ æŸ“
â— Day 8: å‡ºç°ç—‡çŠ¶ï¼ˆdur_inf2sym â‰ˆ 5å¤©ï¼‰
â— Day 8-18: ç—‡çŠ¶æœŸï¼ˆdur_mild2rec â‰ˆ 10å¤©ï¼‰
â— Day 18: åº·å¤
ä»£ç :
# åœ¨ infect() ä¸­
mild_inds = symp_inds[~is_sev]
dur_mild2rec = cvu.sample(dist='lognormal', par1=8, par2=2, size=len(mild_inds))
self.date_recovered[mild_inds] = self.date_symptomatic[mild_inds] + dur_mild2rec

6.3 è·¯å¾„3ï¼šé‡ç—‡ä½†éå±é‡ï¼ˆSevereï¼‰
susceptible â†’ exposed â†’ infectious â†’ symptomatic â†’ severe â†’ recovered
    (day 0)     (day 1)   (day 3)      (day 8)     (day 14)  (day 28)
æ¯”ä¾‹: çº¦ 5-15%ï¼ˆåœ¨æ‰€æœ‰æ„ŸæŸ“ä¸­ï¼‰
æ—¶é—´çº¿:
â— Day 0-8: åŒè½»ç—‡
â— Day 14: ç—‡çŠ¶åŠ é‡ï¼Œéœ€è¦ä½é™¢ï¼ˆdur_sym2sev â‰ˆ 6å¤©ï¼‰
â— Day 14-28: ä½é™¢æ²»ç–—ï¼ˆdur_sev2rec â‰ˆ 14å¤©ï¼‰
â— Day 28: åº·å¤
ä»£ç :
# åœ¨ infect() ä¸­
non_crit_inds = sev_inds[~is_crit]
dur_sev2rec = cvu.sample(dist='lognormal', par1=11, par2=2, size=len(non_crit_inds))
self.date_recovered[non_crit_inds] = self.date_severe[non_crit_inds] + dur_sev2rec

6.4 è·¯å¾„4ï¼šå±é‡ä½†å­˜æ´»ï¼ˆCritical - Surviveï¼‰
susceptible â†’ exposed â†’ infectious â†’ symptomatic â†’ severe â†’ critical â†’ recovered
    (day 0)     (day 1)   (day 3)      (day 8)     (day 14)  (day 18)   (day 38)
æ¯”ä¾‹: çº¦ 1-5%ï¼ˆåœ¨æ‰€æœ‰æ„ŸæŸ“ä¸­ï¼‰
æ—¶é—´çº¿:
â— Day 0-14: åŒé‡ç—‡
â— Day 18: è¿›å…¥å±é‡çŠ¶æ€ï¼Œéœ€è¦ICUï¼ˆdur_sev2crit â‰ˆ 4å¤©ï¼‰
â— Day 18-38: ICUæ²»ç–—ï¼ˆdur_crit2rec â‰ˆ 20å¤©ï¼‰
â— Day 38: åº·å¤
ä»£ç :
# åœ¨ infect() ä¸­
alive_inds = crit_inds[~is_dead]
dur_crit2rec = cvu.sample(dist='lognormal', par1=18, par2=6, size=len(alive_inds))
self.date_recovered[alive_inds] = self.date_critical[alive_inds] + dur_crit2rec

6.5 è·¯å¾„5ï¼šå±é‡å¹¶æ­»äº¡ï¼ˆCritical - Deathï¼‰
susceptible â†’ exposed â†’ infectious â†’ symptomatic â†’ severe â†’ critical â†’ dead
    (day 0)     (day 1)   (day 3)      (day 8)     (day 14)  (day 18)  (day 28)
æ¯”ä¾‹: çº¦ 0.5-3%ï¼ˆåœ¨æ‰€æœ‰æ„ŸæŸ“ä¸­ï¼‰
æ—¶é—´çº¿:
â— Day 0-18: åŒå±é‡å­˜æ´»è·¯å¾„
â— Day 28: æ­»äº¡ï¼ˆdur_crit2die â‰ˆ 10å¤©ï¼‰
ä»£ç :
# åœ¨ infect() ä¸­
dead_inds = crit_inds[is_dead]
dur_crit2die = cvu.sample(dist='lognormal', par1=10, par2=5, size=len(dead_inds))
self.date_dead[dead_inds] = self.date_critical[dead_inds] + dur_crit2die

7. å¹²é¢„æªæ–½ç›¸å…³çŠ¶æ€
7.1 æµ‹è¯•å’Œè¯Šæ–­
# åº”ç”¨æµ‹è¯•å¹²é¢„
tp = cv.test_prob(symp_prob=0.2, asymp_prob=0.01, start_day=20)

# åœ¨æ¨¡æ‹Ÿä¸­çš„æ•ˆæœï¼š
# 1. tested = Trueï¼ˆæ¥å—æ£€æµ‹ï¼‰
people.test(inds, test_sensitivity=0.9, test_delay=2)

# 2. å¦‚æœé˜³æ€§ï¼šdate_diagnosed = t + test_delay
# 3. diagnosed = Trueï¼ˆç¡®è¯Šï¼‰
# 4. isolated = Trueï¼ˆè¿›å…¥éš”ç¦»ï¼‰
7.2 æ¥è§¦è€…è¿½è¸ª
# åº”ç”¨æ¥è§¦è€…è¿½è¸ª
ct = cv.contact_tracing(trace_probs=0.5, trace_time=2, start_day=20)

# åœ¨æ¨¡æ‹Ÿä¸­çš„æ•ˆæœï¼š
# 1. å½“æŸäººè¢«è¯Šæ–­æ—¶
if people.diagnosed[ind]:
    # 2. æ‰¾åˆ°å…¶æ¥è§¦è€…
    contacts = people.contacts['h'][ind]  # å®¶åº­æ¥è§¦è€…
    
    # 3. æ ‡è®°ä¸ºå·²çŸ¥æ¥è§¦è€…
    people.known_contact[contacts] = True
    
    # 4. å®‰æ’éš”ç¦»
    people.schedule_quarantine(contacts, start_date=t+2, period=14)
    
    # 5. quarantined = Trueï¼ˆè¿›å…¥éš”ç¦»ï¼‰
7.3 ç–«è‹—æ¥ç§
# åº”ç”¨ç–«è‹—æ¥ç§
vx = cv.vaccinate_prob('pfizer', days=50, prob=0.01)

# åœ¨æ¨¡æ‹Ÿä¸­çš„æ•ˆæœï¼š
# 1. vaccinated = True
people.vaccinated[inds] = True
people.date_vaccinated[inds] = t

# 2. æ›´æ–°å…ç–«çŠ¶æ€
if use_waning:
    # å¢åŠ ä¸­å’ŒæŠ—ä½“
    cvi.update_peak_nab(people, inds, nab_pars=vaccine_pars)
    
    # 3. é™ä½æ˜“æ„Ÿæ€§ã€ç—‡çŠ¶æ¦‚ç‡ã€é‡ç—‡æ¦‚ç‡
    # é€šè¿‡ sus_imm, symp_imm, sev_imm çŸ©é˜µ

8. æ—¶é—´å‚æ•°
8.1 ç–¾ç—…è¿›å±•æ—¶é—´
æ‰€æœ‰æ—¶é—´å‚æ•°å­˜å‚¨åœ¨ sim.pars['dur'] ä¸­ï¼Œä½¿ç”¨å¯¹æ•°æ­£æ€åˆ†å¸ƒï¼š
'dur': {
    # æš´éœ²åˆ°ä¼ æŸ“ï¼ˆæ½œä¼æœŸï¼‰
    'exp2inf': {
        'dist': 'lognormal',
        'par1': 1.1,      # å‡å€¼ï¼ˆå¯¹æ•°ç©ºé—´ï¼‰
        'par2': 0.9,      # æ ‡å‡†å·®ï¼ˆå¯¹æ•°ç©ºé—´ï¼‰
    },  # å®é™…çº¦ 1-3 å¤©
    
    # ä¼ æŸ“åˆ°ç—‡çŠ¶
    'inf2sym': {
        'dist': 'lognormal',
        'par1': 1.0,
        'par2': 0.9,
    },  # å®é™…çº¦ 3-7 å¤©
    
    # æ— ç—‡çŠ¶åº·å¤æ—¶é—´
    'asym2rec': {
        'dist': 'lognormal',
        'par1': 8.0,
        'par2': 2.0,
    },  # å®é™…çº¦ 5-10 å¤©
    
    # è½»ç—‡åº·å¤æ—¶é—´
    'mild2rec': {
        'dist': 'lognormal',
        'par1': 8.0,
        'par2': 2.0,
    },  # å®é™…çº¦ 5-12 å¤©
    
    # ç—‡çŠ¶åˆ°é‡ç—‡
    'sym2sev': {
        'dist': 'lognormal',
        'par1': 6.6,
        'par2': 4.9,
    },  # å®é™…çº¦ 3-10 å¤©
    
    # é‡ç—‡åº·å¤æ—¶é—´
    'sev2rec': {
        'dist': 'lognormal',
        'par1': 11.0,
        'par2': 2.0,
    },  # å®é™…çº¦ 7-18 å¤©
    
    # é‡ç—‡åˆ°å±é‡
    'sev2crit': {
        'dist': 'lognormal',
        'par1': 1.5,
        'par2': 2.0,
    },  # å®é™…çº¦ 1-5 å¤©
    
    # å±é‡åº·å¤æ—¶é—´
    'crit2rec': {
        'dist': 'lognormal',
        'par1': 18.1,
        'par2': 6.3,
    },  # å®é™…çº¦ 10-30 å¤©
    
    # å±é‡åˆ°æ­»äº¡
    'crit2die': {
        'dist': 'lognormal',
        'par1': 10.7,
        'par2': 4.8,
    },  # å®é™…çº¦ 5-15 å¤©
}
8.2 æ—¶é—´çº¿å¯è§†åŒ–
æ„ŸæŸ“è·¯å¾„æ—¶é—´çº¿ï¼ˆå¤©ï¼‰

æ— ç—‡çŠ¶:
0â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€10
|  |            |
E  I            R

è½»ç—‡:
0â”€â”€3â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€18
|  |      |            |
E  I      S            R

é‡ç—‡:
0â”€â”€3â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€14â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€28
|  |      |     |              |
E  I      S     Sev            R

å±é‡(å­˜æ´»):
0â”€â”€3â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€14â”€â”€â”€â”€18â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€38
|  |      |     |     |               |
E  I      S     Sev   Crit            R

å±é‡(æ­»äº¡):
0â”€â”€3â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€14â”€â”€â”€â”€18â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€28
|  |      |     |     |          |
E  I      S     Sev   Crit       D

å›¾ä¾‹:
E = Exposed (æš´éœ²)
I = Infectious (ä¼ æŸ“)
S = Symptomatic (ç—‡çŠ¶)
Sev = Severe (é‡ç—‡)
Crit = Critical (å±é‡)
R = Recovered (åº·å¤)
D = Dead (æ­»äº¡)

9. å®Œæ•´ç¤ºä¾‹
ç¤ºä¾‹ 1: è¿½è¸ªä¸ªä½“çš„çŠ¶æ€è½¬æ¢
import covasim as cv
import numpy as np

# åˆ›å»ºæ¨¡æ‹Ÿ
sim = cv.Sim(
    pop_size=1000,
    pop_infected=10,
    n_days=100,
    verbose=0
)

# è¿è¡Œæ¨¡æ‹Ÿ
sim.run()

# é€‰æ‹©ä¸€ä¸ªæ„ŸæŸ“è€…
infected_inds = cv.true(~sim.people.susceptible)
if len(infected_inds) > 0:
    uid = infected_inds[10]  # é€‰æ‹©ç¬¬11ä¸ªæ„ŸæŸ“è€…
    
    # ä½¿ç”¨ story() æ–¹æ³•æŸ¥çœ‹ä¸ªä½“å†å²
    sim.people.story(uid)
    
    # æ‰‹åŠ¨æŸ¥çœ‹çŠ¶æ€è½¬æ¢
    p = sim.people[uid]
    print(f"\nè¯¦ç»†çŠ¶æ€è½¬æ¢:")
    print(f"å¹´é¾„: {p.age:.0f} å²")
    print(f"æ€§åˆ«: {'å¥³' if p.sex == 0 else 'ç”·'}")
    print(f"\næ—¶é—´çº¿:")
    
    if not np.isnan(p.date_exposed):
        print(f"  Day {p.date_exposed:.0f}: æš´éœ² (exposed)")
    if not np.isnan(p.date_infectious):
        print(f"  Day {p.date_infectious:.0f}: å¼€å§‹ä¼ æŸ“ (infectious)")
    if not np.isnan(p.date_symptomatic):
        print(f"  Day {p.date_symptomatic:.0f}: å‡ºç°ç—‡çŠ¶ (symptomatic)")
    if not np.isnan(p.date_severe):
        print(f"  Day {p.date_severe:.0f}: é‡ç—‡ (severe)")
    if not np.isnan(p.date_critical):
        print(f"  Day {p.date_critical:.0f}: å±é‡ (critical)")
    if not np.isnan(p.date_recovered):
        print(f"  Day {p.date_recovered:.0f}: åº·å¤ (recovered)")
    if not np.isnan(p.date_dead):
        print(f"  Day {p.date_dead:.0f}: æ­»äº¡ (dead)")
    
    print(f"\næ€»ç—…ç¨‹: {p.dur_disease:.1f} å¤©")
ç¤ºä¾‹ 2: ç»Ÿè®¡å„çŠ¶æ€äººæ•°
import covasim as cv
import matplotlib.pyplot as plt

# åˆ›å»ºåˆ†æå™¨è¿½è¸ªæ‰€æœ‰çŠ¶æ€
class state_tracker(cv.Analyzer):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.states = [
            'susceptible', 'exposed', 'infectious', 'symptomatic',
            'severe', 'critical', 'recovered', 'dead'
        ]
    
    def initialize(self, sim):
        super().initialize()
        self.results = {state: [] for state in self.states}
        self.timepoints = []
    
    def apply(self, sim):
        self.timepoints.append(sim.t)
        for state in self.states:
            count = sim.people[state].sum()
            self.results[state].append(count)
    
    def plot(self):
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # ç–¾ç—…çŠ¶æ€
        ax = axes[0, 0]
        ax.plot(self.timepoints, self.results['susceptible'], label='Susceptible')
        ax.plot(self.timepoints, self.results['exposed'], label='Exposed')
        ax.plot(self.timepoints, self.results['infectious'], label='Infectious')
        ax.set_xlabel('Day')
        ax.set_ylabel('Number of people')
        ax.set_title('Disease progression states')
        ax.legend()
        ax.grid(alpha=0.3)
        
        # ç—‡çŠ¶çŠ¶æ€
        ax = axes[0, 1]
        ax.plot(self.timepoints, self.results['symptomatic'], label='Symptomatic')
        ax.plot(self.timepoints, self.results['severe'], label='Severe')
        ax.plot(self.timepoints, self.results['critical'], label='Critical')
        ax.set_xlabel('Day')
        ax.set_ylabel('Number of people')
        ax.set_title('Symptom severity states')
        ax.legend()
        ax.grid(alpha=0.3)
        
        # ç»“æœçŠ¶æ€
        ax = axes[1, 0]
        ax.plot(self.timepoints, self.results['recovered'], label='Recovered', color='green')
        ax.plot(self.timepoints, self.results['dead'], label='Dead', color='red')
        ax.set_xlabel('Day')
        ax.set_ylabel('Number of people')
        ax.set_title('Outcome states')
        ax.legend()
        ax.grid(alpha=0.3)
        
        # æ„ŸæŸ“æ¯”ä¾‹
        ax = axes[1, 1]
        total = len(sim.people)
        infected_ratio = [(total - s) / total * 100 for s in self.results['susceptible']]
        ax.plot(self.timepoints, infected_ratio)
        ax.set_xlabel('Day')
        ax.set_ylabel('Percentage (%)')
        ax.set_title('Cumulative infection rate')
        ax.grid(alpha=0.3)
        
        plt.tight_layout()
        return fig

# è¿è¡Œæ¨¡æ‹Ÿ
tracker = state_tracker()
sim = cv.Sim(pop_size=5000, pop_infected=50, n_days=120, analyzers=tracker)
sim.run()

# ç»˜å›¾
sim.plot()
tracker.plot()
plt.show()
ç¤ºä¾‹ 3: æ¨¡æ‹ŸçŠ¶æ€è½¬æ¢çŸ©é˜µ
import covasim as cv
import numpy as np
import pandas as pd

# åˆ›å»ºæ¨¡æ‹Ÿ
sim = cv.Sim(pop_size=10000, pop_infected=100, n_days=150)
sim.run()

# åˆ†æçŠ¶æ€è½¬æ¢
people = sim.people

# ç»Ÿè®¡å„çŠ¶æ€äººæ•°
states_to_check = [
    ('exposed', 'æš´éœ²'),
    ('infectious', 'ä¼ æŸ“'),
    ('symptomatic', 'ç—‡çŠ¶'),
    ('severe', 'é‡ç—‡'),
    ('critical', 'å±é‡'),
    ('recovered', 'åº·å¤'),
    ('dead', 'æ­»äº¡'),
    ('tested', 'å·²æµ‹è¯•'),
    ('diagnosed', 'å·²è¯Šæ–­'),
]

print("=" * 60)
print("çŠ¶æ€ç»Ÿè®¡")
print("=" * 60)

# åˆ›å»ºç»Ÿè®¡è¡¨
data = []
for state, name in states_to_check:
    count = people[state].sum()
    percentage = count / len(people) * 100
    data.append({
        'çŠ¶æ€': name,
        'è‹±æ–‡': state,
        'äººæ•°': count,
        'æ¯”ä¾‹(%)': f'{percentage:.2f}'
    })

df = pd.DataFrame(data)
print(df.to_string(index=False))

# åˆ†æç–¾ç—…è·¯å¾„
print("\n" + "=" * 60)
print("ç–¾ç—…è·¯å¾„åˆ†æ")
print("=" * 60)

# æ‰¾åˆ°æ‰€æœ‰æ›¾ç»æ„ŸæŸ“çš„äºº
ever_infected = cv.true(~people.naive)

if len(ever_infected) > 0:
    # æ— ç—‡çŠ¶æ„ŸæŸ“
    asymp = cv.true(ever_infected & ~people.symptomatic & people.recovered)
    
    # è½»ç—‡
    mild = cv.true(ever_infected & people.symptomatic & ~people.severe & people.recovered)
    
    # é‡ç—‡éå±é‡
    severe_not_crit = cv.true(ever_infected & people.severe & ~people.critical & people.recovered)
    
    # å±é‡å­˜æ´»
    crit_survive = cv.true(ever_infected & people.critical & people.recovered)
    
    # å±é‡æ­»äº¡
    crit_dead = cv.true(ever_infected & people.critical & people.dead)
    
    # æ‰“å°ç»Ÿè®¡
    pathways = [
        ('æ— ç—‡çŠ¶', len(asymp)),
        ('è½»ç—‡', len(mild)),
        ('é‡ç—‡ï¼ˆéå±é‡ï¼‰', len(severe_not_crit)),
        ('å±é‡ï¼ˆå­˜æ´»ï¼‰', len(crit_survive)),
        ('å±é‡ï¼ˆæ­»äº¡ï¼‰', len(crit_dead)),
    ]
    
    total_infected = len(ever_infected)
    print(f"æ€»æ„ŸæŸ“äººæ•°: {total_infected}\n")
    
    for pathway, count in pathways:
        percentage = count / total_infected * 100
        print(f"{pathway:12s}: {count:5d} ({percentage:5.2f}%)")
    
    # ç—…æ­»ç‡
    cfr = len(crit_dead) / total_infected * 100
    print(f"\nç—…æ­»ç‡ (CFR): {cfr:.2f}%")
ç¤ºä¾‹ 4: è‡ªå®šä¹‰çŠ¶æ€è½¬æ¢åˆ†æ
import covasim as cv
import numpy as np
import matplotlib.pyplot as plt

class transition_analyzer(cv.Analyzer):
    '''åˆ†æçŠ¶æ€è½¬æ¢çš„æ—¶é—´'''
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
    
    def initialize(self, sim):
        super().initialize()
        self.transitions = {
            'exp2inf': [],    # æš´éœ²åˆ°ä¼ æŸ“
            'inf2sym': [],    # ä¼ æŸ“åˆ°ç—‡çŠ¶
            'sym2sev': [],    # ç—‡çŠ¶åˆ°é‡ç—‡
            'sev2crit': [],   # é‡ç—‡åˆ°å±é‡
            'exp2rec': [],    # æš´éœ²åˆ°åº·å¤ï¼ˆæ€»ç—…ç¨‹ï¼‰
        }
    
    def finalize(self, sim):
        super().finalize()
        
        people = sim.people
        
        # æ”¶é›†è½¬æ¢æ—¶é—´
        for i in range(len(people)):
            # è·³è¿‡æœªæ„ŸæŸ“çš„äºº
            if people.naive[i]:
                continue
            
            # æš´éœ²åˆ°ä¼ æŸ“
            if not np.isnan(people.dur_exp2inf[i]):
                self.transitions['exp2inf'].append(people.dur_exp2inf[i])
            
            # ä¼ æŸ“åˆ°ç—‡çŠ¶
            if not np.isnan(people.dur_inf2sym[i]):
                self.transitions['inf2sym'].append(people.dur_inf2sym[i])
            
            # ç—‡çŠ¶åˆ°é‡ç—‡
            if not np.isnan(people.dur_sym2sev[i]):
                self.transitions['sym2sev'].append(people.dur_sym2sev[i])
            
            # é‡ç—‡åˆ°å±é‡
            if not np.isnan(people.dur_sev2crit[i]):
                self.transitions['sev2crit'].append(people.dur_sev2crit[i])
            
            # æ€»ç—…ç¨‹
            if not np.isnan(people.dur_disease[i]):
                self.transitions['exp2rec'].append(people.dur_disease[i])
    
    def plot(self):
        fig, axes = plt.subplots(2, 3, figsize=(15, 10))
        axes = axes.flatten()
        
        titles = {
            'exp2inf': 'æš´éœ²åˆ°ä¼ æŸ“æœŸ (Exposed â†’ Infectious)',
            'inf2sym': 'ä¼ æŸ“åˆ°ç—‡çŠ¶æœŸ (Infectious â†’ Symptomatic)',
            'sym2sev': 'ç—‡çŠ¶åˆ°é‡ç—‡ (Symptomatic â†’ Severe)',
            'sev2crit': 'é‡ç—‡åˆ°å±é‡ (Severe â†’ Critical)',
            'exp2rec': 'æ€»ç—…ç¨‹ (Exposed â†’ Recovered)',
        }
        
        for idx, (key, data) in enumerate(self.transitions.items()):
            if len(data) > 0:
                ax = axes[idx]
                ax.hist(data, bins=30, edgecolor='black', alpha=0.7)
                ax.axvline(np.mean(data), color='red', linestyle='--', 
                          label=f'Mean: {np.mean(data):.1f} days')
                ax.axvline(np.median(data), color='green', linestyle='--',
                          label=f'Median: {np.median(data):.1f} days')
                ax.set_xlabel('Days')
                ax.set_ylabel('Count')
                ax.set_title(titles[key])
                ax.legend()
                ax.grid(alpha=0.3)
                
                # æ‰“å°ç»Ÿè®¡
                print(f"\n{titles[key]}:")
                print(f"  æ ·æœ¬æ•°: {len(data)}")
                print(f"  å‡å€¼: {np.mean(data):.2f} å¤©")
                print(f"  ä¸­ä½æ•°: {np.median(data):.2f} å¤©")
                print(f"  æ ‡å‡†å·®: {np.std(data):.2f} å¤©")
                print(f"  èŒƒå›´: {np.min(data):.2f} - {np.max(data):.2f} å¤©")
        
        # åˆ é™¤å¤šä½™çš„å­å›¾
        if len(self.transitions) < 6:
            for idx in range(len(self.transitions), 6):
                fig.delaxes(axes[idx])
        
        plt.tight_layout()
        return fig

# è¿è¡Œæ¨¡æ‹Ÿ
analyzer = transition_analyzer()
sim = cv.Sim(pop_size=10000, pop_infected=100, n_days=150, analyzers=analyzer)
sim.run()

# ç»˜å›¾
analyzer.plot()
plt.show()

10. å¸¸è§é—®é¢˜
Q1: susceptible å’Œ naive æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
susceptibleï¼ˆæ˜“æ„Ÿï¼‰: å½“å‰å¯ä»¥è¢«æ„ŸæŸ“
â— åˆå§‹: True
â— æ„ŸæŸ“å: False
â— åº·å¤åï¼ˆå¦‚æœ use_waning=Trueï¼‰: Trueï¼ˆé‡æ–°æ˜“æ„Ÿï¼‰
naiveï¼ˆå¤©çœŸï¼‰: ä»æœªæ¥è§¦è¿‡ç—…æ¯’æˆ–ç–«è‹—
â— åˆå§‹: True
â— é¦–æ¬¡æ„ŸæŸ“/æ¥ç§å: Falseï¼ˆæ°¸è¿œä¸ä¼šå†å˜ä¸º Trueï¼‰
å…³é”®åŒºåˆ«:
# å¯èƒ½çš„ç»„åˆ
susceptible=True,  naive=True   # ä»æœªæ¥è§¦ï¼Œå¯è¢«æ„ŸæŸ“
susceptible=False, naive=True   # é¦–æ¬¡æ„ŸæŸ“ä¸­
susceptible=False, naive=False  # åº·å¤æœŸï¼ˆæœ‰å…ç–«ï¼‰
susceptible=True,  naive=False  # äºŒæ¬¡æ˜“æ„Ÿï¼ˆå…ç–«è¡°å‡åï¼‰

Q2: quarantined å’Œ isolated æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
quarantinedï¼ˆæ£€ç–«éš”ç¦»ï¼‰:
â— é€‚ç”¨äºï¼šç–‘ä¼¼æ¥è§¦è€…
â— è§¦å‘ï¼šæ¥è§¦è€…è¿½è¸ª
â— æŒç»­ï¼šå›ºå®šæœŸé™ï¼ˆé€šå¸¸14å¤©ï¼‰
â— çŠ¶æ€ï¼šå¯èƒ½æœªè¢«æ„ŸæŸ“
isolatedï¼ˆéš”ç¦»ï¼‰:
â— é€‚ç”¨äºï¼šç¡®è¯Šç—…ä¾‹
â— è§¦å‘ï¼šè·å¾—è¯Šæ–­
â— æŒç»­ï¼šç›´åˆ°åº·å¤
â— çŠ¶æ€ï¼šå·²ç¡®è®¤æ„ŸæŸ“
è½¬æ¢:
known_contact â†’ quarantined
               â†“ (å¦‚æœè¢«è¯Šæ–­)
            isolated

Q3: å¦‚ä½•ç¡®å®šæŸäººçš„ç–¾ç—…ä¸¥é‡ç¨‹åº¦ï¼Ÿ
# åœ¨æ¨¡æ‹Ÿè¿è¡Œå
people = sim.people

# æ£€æŸ¥ä¸ªä½“ i çš„ä¸¥é‡ç¨‹åº¦
i = 100

if people.dead[i]:
    severity = "æ­»äº¡"
elif people.critical[i] or not np.isnan(people.date_critical[i]):
    severity = "å±é‡"
elif people.severe[i] or not np.isnan(people.date_severe[i]):
    severity = "é‡ç—‡"
elif people.symptomatic[i] or not np.isnan(people.date_symptomatic[i]):
    severity = "è½»ç—‡"
elif people.exposed[i] or people.recovered[i]:
    severity = "æ— ç—‡çŠ¶"
else:
    severity = "æœªæ„ŸæŸ“"

print(f"ä¸ªä½“ {i} çš„ä¸¥é‡ç¨‹åº¦: {severity}")

Q4: çŠ¶æ€è½¬æ¢çš„é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ
æ¯ä¸ªæ—¶é—´æ­¥çš„é¡ºåºï¼ˆåœ¨ sim.step() ä¸­ï¼‰:
1. update_states_pre(t):
   - check_infectious()      # æš´éœ² â†’ ä¼ æŸ“
   - check_symptomatic()     # â†’ ç—‡çŠ¶
   - check_severe()          # â†’ é‡ç—‡
   - check_critical()        # â†’ å±é‡
   - check_recovery()        # â†’ åº·å¤
   - check_death()           # â†’ æ­»äº¡
   - check_immunity()        # æ›´æ–°å…ç–«

2. compute_infections():     # è®¡ç®—æ–°æ„ŸæŸ“

3. update_states_post():
   - check_diagnosed()       # æµ‹è¯• â†’ è¯Šæ–­
   - check_quar()            # éš”ç¦»ç®¡ç†
   - check_enter_iso()       # è¯Šæ–­ â†’ éš”ç¦»

Q5: å¦‚ä½•è®¿é—®æŸä¸ªçŠ¶æ€çš„å†å²ï¼Ÿ
Covasim ä¸ä¼šè‡ªåŠ¨ä¿å­˜æ‰€æœ‰çŠ¶æ€çš„å†å²ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨ Analyzerï¼š
class state_history_tracker(cv.Analyzer):
    def __init__(self, states_to_track, **kwargs):
        super().__init__(**kwargs)
        self.states_to_track = states_to_track
    
    def initialize(self, sim):
        super().initialize()
        self.history = {state: [] for state in self.states_to_track}
        self.timepoints = []
    
    def apply(self, sim):
        self.timepoints.append(sim.t)
        for state in self.states_to_track:
            # ä¿å­˜å½“å‰çŠ¶æ€çš„å‰¯æœ¬
            self.history[state].append(sim.people[state].copy())
    
    def get_individual_history(self, uid):
        '''è·å–æŸä¸ªä¸ªä½“çš„çŠ¶æ€å†å²'''
        history = {}
        for state in self.states_to_track:
            history[state] = [day_data[uid] for day_data in self.history[state]]
        return history

# ä½¿ç”¨
tracker = state_history_tracker(['exposed', 'infectious', 'symptomatic', 'recovered'])
sim = cv.Sim(analyzers=tracker)
sim.run()

# æŸ¥çœ‹ä¸ªä½“100çš„å†å²
uid_history = tracker.get_individual_history(100)
print(f"Exposed history: {uid_history['exposed']}")

Q6: å¦‚ä½•ä¿®æ”¹çŠ¶æ€è½¬æ¢çš„æ¦‚ç‡ï¼Ÿ
# ä¿®æ”¹ç–¾ç—…è¿›å±•æ¦‚ç‡
sim = cv.Sim()

# åœ¨åˆå§‹åŒ–åä¿®æ”¹
sim.initialize()

# ä¿®æ”¹ç—‡çŠ¶æ¦‚ç‡ï¼ˆå¹´é¾„ç›¸å…³ï¼‰
# ä½¿ æ‰€æœ‰äººç—‡çŠ¶æ¦‚ç‡é™ä½50%
sim.people.symp_prob *= 0.5

# ä¿®æ”¹é‡ç—‡æ¦‚ç‡
sim.people.severe_prob *= 0.8

# ä¿®æ”¹æ­»äº¡æ¦‚ç‡
sim.people.death_prob *= 0.7

# ç„¶åè¿è¡Œ
sim.run()
æˆ–è€…ä¿®æ”¹ prognoses å‚æ•°ï¼š
# è‡ªå®šä¹‰é¢„åå‚æ•°
pars = {
    'prognoses': {
        'age_cutoffs': [0, 10, 20, 30, 40, 50, 60, 70, 80, 90],
        'symp_probs': [0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95],
        'severe_probs': [0.01, 0.01, 0.02, 0.03, 0.05, 0.08, 0.12, 0.18, 0.25, 0.35],
        # ... å…¶ä»–å‚æ•°
    }
}

sim = cv.Sim(pars=pars)

Q7: ä¸ºä»€ä¹ˆæŸäº›äººè·³è¿‡æŸäº›çŠ¶æ€ï¼Ÿ
è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºç–¾ç—…è¿›å±•æ˜¯åˆ†æ”¯çš„ï¼š
# ä¸æ˜¯æ‰€æœ‰äººéƒ½ç»å†æ‰€æœ‰çŠ¶æ€
exposed â†’ infectious â†’ [åˆ†æ”¯ç‚¹]
                        â”œâ†’ æ— ç—‡çŠ¶ â†’ recovered
                        â””â†’ symptomatic â†’ [åˆ†æ”¯ç‚¹]
                                          â”œâ†’ è½»ç—‡ â†’ recovered
                                          â””â†’ severe â†’ [åˆ†æ”¯ç‚¹]
                                                       â”œâ†’ recovered
                                                       â””â†’ critical â†’ [æ­»äº¡æˆ–åº·å¤]
ç¤ºä¾‹ï¼š
â— 30-50% çš„äººä» infectious ç›´æ¥åˆ° recoveredï¼ˆæ— ç—‡çŠ¶ï¼‰
â— 80-90% çš„æœ‰ç—‡çŠ¶è€…ä¸ä¼šè¿›å…¥ severe
â— 70-90% çš„é‡ç—‡è€…ä¸ä¼šè¿›å…¥ critical

11. æ€»ç»“
æ ¸å¿ƒè¦ç‚¹
1. 16ä¸ªçŠ¶æ€: æ¶µç›–ç–¾ç—…è¿›å±•ã€æ£€æµ‹ã€å¹²é¢„
2. åˆ†æ”¯è¿›å±•: ç–¾ç—…è·¯å¾„æ˜¯åˆ†æ”¯çš„ï¼Œä¸æ˜¯çº¿æ€§çš„
æ‰€æœ‰æ„ŸæŸ“è€… â†’ æ— ç—‡çŠ¶ or æœ‰ç—‡çŠ¶
æœ‰ç—‡çŠ¶è€… â†’ è½»ç—‡ or é‡ç—‡
é‡ç—‡è€… â†’ åº·å¤ or å±é‡
å±é‡è€… â†’ åº·å¤ or æ­»äº¡
3. ä¸¤ç§è½¬æ¢:
  â—‹ æ—¶é—´é©±åŠ¨: exposed â†’ infectious â†’ symptomatic ç­‰
  â—‹ æ¦‚ç‡é©±åŠ¨: æ˜¯å¦æœ‰ç—‡çŠ¶ã€æ˜¯å¦é‡ç—‡ç­‰
4. å…³é”®å‡½æ•°:
  â—‹ infect(): ç¡®å®šç–¾ç—…è·¯å¾„
  â—‹ check_*(): æ‰§è¡Œæ—¶é—´é©±åŠ¨çš„è½¬æ¢
  â—‹ update_states_pre/post(): ä¸»å¾ªç¯
5. æ—¶é—´å‚æ•°: æ‰€æœ‰è½¬æ¢æ—¶é—´ä»å¯¹æ•°æ­£æ€åˆ†å¸ƒé‡‡æ ·
çŠ¶æ€é€ŸæŸ¥è¡¨
çŠ¶æ€	åˆå§‹å€¼	ä½•æ—¶å˜True	ä½•æ—¶å˜False	æŒç»­æ—¶é—´
susceptible	True	åº·å¤åï¼ˆè¡°å‡æ¨¡å¼ï¼‰	æ„ŸæŸ“æ—¶	-
naive	True	-	é¦–æ¬¡æ„ŸæŸ“/æ¥ç§	æ°¸ä¹…
exposed	False	æ„ŸæŸ“æ—¶	åº·å¤/æ­»äº¡	1-3å¤©
infectious	False	exposedå	åº·å¤/æ­»äº¡	7-21å¤©
symptomatic	False	infectiousåï¼ˆéƒ¨åˆ†äººï¼‰	åº·å¤/æ­»äº¡	10-30å¤©
severe	False	symptomaticåï¼ˆå°‘æ•°ï¼‰	åº·å¤/æ­»äº¡	14-35å¤©
critical	False	severeåï¼ˆæå°‘æ•°ï¼‰	åº·å¤/æ­»äº¡	20-56å¤©
tested	False	æ¥å—æ£€æµ‹æ—¶	-	æ°¸ä¹…
diagnosed	False	æ£€æµ‹é˜³æ€§å	-	æ°¸ä¹…
recovered	False	ç—…ç¨‹ç»“æŸ	å†æ¬¡æ„ŸæŸ“	æ°¸ä¹…ï¼ˆæˆ–ç›´åˆ°å†æ„ŸæŸ“ï¼‰
dead	False	å±é‡åï¼ˆæ¦‚ç‡ï¼‰	-	æ°¸ä¹…
known_dead	False	è¯Šæ–­åæ­»äº¡	-	æ°¸ä¹…
known_contact	False	æ¥è§¦è€…è¿½è¸ªè¯†åˆ«	-	-
quarantined	False	æ¥è§¦è€…éš”ç¦»	æœŸé™åˆ°/è¯Šæ–­	14å¤©ï¼ˆé»˜è®¤ï¼‰
isolated	False	è¯Šæ–­æ—¶	åº·å¤	ç›´åˆ°åº·å¤
vaccinated	False	æ¥ç§ç–«è‹—æ—¶	-	æ°¸ä¹…

12. å‚è€ƒèµ„æº
Covasim æºä»£ç 
â— people.py: æ‰€æœ‰çŠ¶æ€è½¬æ¢é€»è¾‘
â— defaults.py: çŠ¶æ€å®šä¹‰å’Œé»˜è®¤å‚æ•°
â— parameters.py: ç–¾ç—…è¿›å±•å‚æ•°
ç›¸å…³ç¤ºä¾‹
â— examples/simple.py: åŸºæœ¬ä½¿ç”¨
â— examples/t01_full_usage_example.py: å®Œæ•´ç¤ºä¾‹
â— people.story(): æŸ¥çœ‹ä¸ªä½“å†å²
å…³é”®æ–¹æ³•
# çŠ¶æ€æ£€æŸ¥
people.check_infectious()
people.check_symptomatic()
people.check_severe()
people.check_critical()
people.check_recovery()
people.check_death()

# äº‹ä»¶è§¦å‘
people.infect(inds)
people.test(inds)
people.schedule_quarantine(inds)

# æŸ¥çœ‹ä¸ªä½“
people.story(uid)
people[uid]  # è·å–ä¸ªä½“æ‰€æœ‰å±æ€§

å¸Œæœ›è¿™ä»½æ–‡æ¡£èƒ½å¸®åŠ©ä½ ç†è§£ Covasim çš„çŠ¶æ€è½¬æ¢æœºåˆ¶ï¼ ğŸ¦ â¡ï¸ğŸ’š
å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿æŸ¥çœ‹æºä»£ç æˆ–è¿è¡Œç¤ºä¾‹ï¼